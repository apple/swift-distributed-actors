{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"LowestReachableMember"}],"languages":["swift"],"platforms":["macOS"]}]},{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"All "},{"type":"codeVoice","code":"MemberStatus.joining"},{"type":"text","text":", "},{"type":"codeVoice","code":"MemberStatus.up"},{"type":"text","text":" "},{"type":"emphasis","inlineContent":[{"type":"text","text":"reachable"}]},{"type":"text","text":" members are sorted by their addresses,"},{"type":"text","text":" "},{"type":"text","text":"and the “lowest” is selected as the leader."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Only REACHABLE nodes are taken into account. This means that in a situation with a cluster partition,"},{"type":"text","text":" "},{"type":"text","text":"there WILL be multiple leaders. In this coordination free scheme, this is needed in order to avoid “getting stuck”,"},{"type":"text","text":" "},{"type":"text","text":"without a leader to perform the unreachable -> down move. \/\/ TODO keep thinking if we can do better here, we could to a quorum downing IMHO, and remove this impl completely as it’s very “bad”."}]},{"anchor":"Use-cases","level":3,"type":"heading","text":"Use cases"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This strategy works well for non critical tasks, which nevertheless benefit from performing them more centrally"},{"type":"text","text":" "},{"type":"text","text":"than either by all nodes at once, or by random nodes."}]},{"anchor":"Guarantees--discussion","level":3,"type":"heading","text":"Guarantees & discussion"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Given at-least "},{"type":"codeVoice","code":"minimumNumberOfMembersToDecide"},{"type":"text","text":" members are present in the membership, is always able to select a leader."}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Even if all members are unreachable, we always have “this member”, which by definition always is reachable."}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"minimumNumberOfMembersToDecide"},{"type":"text","text":" is used to delay moving members to "},{"type":"codeVoice","code":".up"},{"type":"text","text":" until the cluster has at least"},{"type":"text","text":" "},{"type":"text","text":"the given number of nodes available. This is useful to only start clustered features or signal readiness once the cluster"},{"type":"text","text":" "},{"type":"text","text":"has enough nodes connected to absorb the anticipated incoming traffic (or ready from a correctness perspective, of at least"},{"type":"text","text":" "},{"type":"text","text":"having a few nodes to fallback to)."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Does NOT guarantee global leader uniqueness!"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"As the leader is decided strictly based on the known list of members and their reachability status, its"},{"type":"text","text":" "},{"type":"text","text":"correctness relies on this membership being “complete”, i.e. if used in a partitioned cluster, where nodes "},{"type":"codeVoice","code":"[a, b, c]"},{"type":"text","text":","},{"type":"text","text":" "},{"type":"text","text":"all see each other as "},{"type":"emphasis","inlineContent":[{"type":"text","text":"reachable"}]},{"type":"text","text":", however view nodes "},{"type":"codeVoice","code":"[x, y]"},{"type":"text","text":" as "},{"type":"emphasis","inlineContent":[{"type":"text","text":"unreachable"}]},{"type":"text","text":" (as marked by e.g. SWIM failure detection),"},{"type":"text","text":" "},{"type":"text","text":"then this leader election will result in "},{"type":"codeVoice","code":"a"},{"type":"text","text":" being the leader in one side of the partition, and potentially "},{"type":"codeVoice","code":"x"},{"type":"text","text":" as the leader"},{"type":"text","text":" "},{"type":"text","text":"in the other “side” of the partition."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This can be advantageous – perhaps a leader on each side should be responsible if the “side” of a partition"},{"type":"text","text":" "},{"type":"text","text":"should better terminate itself as it is the “smaller side of a partition” and may prefer to terminate"},{"type":"text","text":" "},{"type":"text","text":"rather than risk data corruption if the nodes "},{"type":"codeVoice","code":"x, y"},{"type":"text","text":" continued writing data."}]}]}]}]}]},{"anchor":"Mode-loseLeadershipIfBelowMinNrOfMembers","level":4,"type":"heading","text":"Mode: loseLeadershipIfBelowMinNrOfMembers"},{"type":"paragraph","inlineContent":[{"type":"text","text":"By default, leadership is elected e.g. among 5 nodes, and if the count of the membership’s reachable nodes"},{"type":"text","text":" "},{"type":"text","text":"falls below "},{"type":"codeVoice","code":"minimumNrOfMembers"},{"type":"text","text":" the leader "},{"type":"emphasis","inlineContent":[{"type":"text","text":"remains"}]},{"type":"text","text":" being the leader (unless the node which became unreachable"},{"type":"text","text":" "},{"type":"text","text":"is the leader itself). This allows for a more stable leadership in face of flaky other nodes."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you prefer the leader to give up its leadership whenever there is less than "},{"type":"codeVoice","code":"minimumNrOfMembers"},{"type":"text","text":" reachable"},{"type":"text","text":" "},{"type":"text","text":"members, you may set "},{"type":"codeVoice","code":"loseLeadershipIfBelowMinNrOfMembers"},{"type":"text","text":" to true. Meaning that the leader will only be"},{"type":"text","text":" "},{"type":"text","text":"fulfilling this role whenever the minimum number of nodes exist. This may be useful when operation would"},{"type":"text","text":" "},{"type":"text","text":"potentially be unsafe given less than "},{"type":"codeVoice","code":"minimumNrOfMembers"},{"type":"text","text":" nodes."}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/distributedactors\/leadership\/lowestreachablemember"],"traits":[{"interfaceLanguage":"swift"}]}],"relationshipsSections":[{"identifiers":["doc:\/\/DistributedActors\/documentation\/DistributedActors\/LeaderElection"],"kind":"relationships","title":"Conforms To","type":"conformsTo"}],"identifier":{"url":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Simple strategy which does not require any additional coordination from members to select a leader."}],"kind":"symbol","metadata":{"navigatorTitle":[{"kind":"identifier","text":"LowestReachableMember"}],"role":"symbol","title":"Leadership.LowestReachableMember","roleHeading":"Structure","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"LowestReachableMember"}],"symbolKind":"struct","externalID":"s:17DistributedActors10LeadershipV21LowestReachableMemberV","extendedModule":"DistributedActors","modules":[{"name":"DistributedActors"}]},"hierarchy":{"paths":[["doc:\/\/DistributedActors\/documentation\/DistributedActors","doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership"]]},"topicSections":[{"title":"Initializers","identifiers":["doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember\/init(minimumNrOfMembers:loseLeadershipIfBelowMinNrOfMembers:)"]},{"title":"Instance Methods","identifiers":["doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember\/runElection(context:membership:)"]}],"references":{"doc://DistributedActors/documentation/DistributedActors/Leadership":{"role":"symbol","title":"Leadership","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Leadership"}],"abstract":[{"type":"text","text":"Leadership encapsulates various "},{"type":"codeVoice","code":"LeaderElection"},{"type":"text","text":" strategies."}],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Leadership"}],"url":"\/documentation\/distributedactors\/leadership"},"doc://DistributedActors/documentation/DistributedActors":{"role":"collection","title":"DistributedActors","abstract":[{"type":"text","text":"A peer-to-peer cluster actor system implementation for Swift."}],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors","kind":"symbol","type":"topic","url":"\/documentation\/distributedactors"},"doc://DistributedActors/documentation/DistributedActors/Leadership/LowestReachableMember":{"role":"symbol","title":"Leadership.LowestReachableMember","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"LowestReachableMember"}],"abstract":[{"type":"text","text":"Simple strategy which does not require any additional coordination from members to select a leader."}],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"LowestReachableMember"}],"url":"\/documentation\/distributedactors\/leadership\/lowestreachablemember"},"doc://DistributedActors/documentation/DistributedActors/LeaderElection":{"role":"symbol","title":"LeaderElection","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"LeaderElection"}],"abstract":[{"type":"text","text":"Leader election allows for determining a “leader” node among members."}],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/LeaderElection","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"LeaderElection"}],"url":"\/documentation\/distributedactors\/leaderelection"},"doc://DistributedActors/documentation/DistributedActors/Leadership/LowestReachableMember/runElection(context:membership:)":{"role":"symbol","title":"runElection(context:membership:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"runElection"},{"kind":"text","text":"("},{"kind":"externalParam","text":"context"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"LeaderElectionContext","preciseIdentifier":"s:17DistributedActors21LeaderElectionContextV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"membership"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Cluster","preciseIdentifier":"s:17DistributedActors7ClusterO"},{"kind":"text","text":"."},{"kind":"typeIdentifier","text":"Membership","preciseIdentifier":"s:17DistributedActors7ClusterO10MembershipV"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"LeaderElectionResult","preciseIdentifier":"s:17DistributedActors20LeaderElectionResultV"}],"abstract":[],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember\/runElection(context:membership:)","kind":"symbol","type":"topic","url":"\/documentation\/distributedactors\/leadership\/lowestreachablemember\/runelection(context:membership:)"},"doc://DistributedActors/documentation/DistributedActors/Leadership/LowestReachableMember/init(minimumNrOfMembers:loseLeadershipIfBelowMinNrOfMembers:)":{"role":"symbol","title":"init(minimumNrOfMembers:loseLeadershipIfBelowMinNrOfMembers:)","fragments":[{"kind":"identifier","text":"init"},{"kind":"text","text":"("},{"kind":"externalParam","text":"minimumNrOfMembers"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int","preciseIdentifier":"s:Si"},{"kind":"text","text":", "},{"kind":"externalParam","text":"loseLeadershipIfBelowMinNrOfMembers"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"},{"kind":"text","text":")"}],"abstract":[],"identifier":"doc:\/\/DistributedActors\/documentation\/DistributedActors\/Leadership\/LowestReachableMember\/init(minimumNrOfMembers:loseLeadershipIfBelowMinNrOfMembers:)","kind":"symbol","type":"topic","url":"\/documentation\/distributedactors\/leadership\/lowestreachablemember\/init(minimumnrofmembers:loseleadershipifbelowminnrofmembers:)"}}}